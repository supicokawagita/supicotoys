<form id="dreamForm">
  <textarea id="dreamInput" placeholder="夢を書いてね" rows="5" required></textarea>
  <button type="submit">送信</button>
</form>
<div id="status"></div>

<script>
  const form = document.getElementById('dreamForm');
  form.addEventListener('submit', async (e) => {
    e.preventDefault();

    const dreamText = document.getElementById('dreamInput').value;
    const url = 'https://script.google.com/macros/s/AKfycbwvxyfJxWLpmo36_m7vJ5U9brzkSgvfXgSu4TCpIeSz_gfMBi3SFzqCEgvSKsTvJSE2Pw/exec';

    const formData = new URLSearchParams();
    formData.append('dream', dreamText);

    try {
      const response = await fetch(url, {
        method: 'POST',
        body: formData
      });

      const text = await response.text();

      if (text.trim() === 'success') {
        document.getElementById('status').textContent = '夢日記送信成功！ありがとう😊';
        form.reset();
      } else {
        document.getElementById('status').textContent = 'サーバー側でエラーが返されました…';
        console.error('Unexpected response:', text);
      }
    } catch (err) {
      document.getElementById('status').textContent = '送信エラーが発生しました…';
      console.error(err);
    }
  });
</script>
